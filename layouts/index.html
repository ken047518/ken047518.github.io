{{ define "main" }}

{{- /* Hero Section */ -}}
<section class="relative h-[60vh] md:h-[80vh] flex items-center justify-center">
  {{- with .Params.hero_image -}}
    {{- $image := $.Resources.Get . -}}
    {{- if $image -}}
      {{- $hero_sm := $image.Resize "960x" -}}
      {{- $hero_md := $image.Resize "1440x" -}}
      {{- $hero_lg := $image.Resize "1920x" -}}
  <img
    src="{{ $hero_md.Permalink }}"
    srcset="{{ $hero_sm.Permalink }} 960w, {{ $hero_md.Permalink }} 1440w, {{ $hero_lg.Permalink }} 1920w"
    sizes="100vw"
    alt="{{ $.Site.Title }}"
    class="absolute inset-0 w-full h-full object-cover"
  >
    {{- end -}}
  {{- end -}}

  <div class="absolute inset-0 bg-black bg-opacity-40"></div>

  <div class="relative z-10 text-center text-white">
    <h1 class="font-heading text-4xl md:text-6xl font-bold mb-4">
      {{ .Page.Title }}
    </h1>
    {{- with .Params.tagline -}}
    <p class="text-xl md:text-2xl">{{ . }}</p>
    {{- end -}}
  </div>
</section>

{{- /* Bio Section */ -}}
<section class="container mx-auto px-4 py-16">
  <div class="flex flex-col md:flex-row items-center gap-8 max-w-4xl mx-auto">
    {{- with .Params.bio_image -}}
      {{- $image := $.Resources.Get . -}}
      {{- if $image -}}
        {{- $bio := $image.Fill "240x240 Center" -}}
        {{- $bio2x := $image.Fill "480x480 Center" -}}
    <div class="flex-shrink-0">
      <img
        src="{{ $bio.Permalink }}"
        srcset="{{ $bio.Permalink }} 1x, {{ $bio2x.Permalink }} 2x"
        alt="{{ $.Params.bio_alt | default "Profile" }}"
        class="w-40 h-40 md:w-60 md:h-60 rounded-full object-cover"
      >
    </div>
      {{- end -}}
    {{- end -}}

    <div class="flex-1 text-center md:text-left">
      {{- with .Content -}}
        {{ . }}
      {{- end -}}
    </div>
  </div>
</section>

{{- /* Featured Posts */ -}}
{{- $featured := where (where .Site.RegularPages "Section" "posts") "Params.featured" true | first 3 -}}
{{- if $featured -}}
<section class="bg-gray-50 dark:bg-gray-800 py-16">
  <div class="container mx-auto px-4">
    <h2 class="font-heading text-3xl md:text-4xl font-bold text-center mb-12">
      {{ if eq .Language.Lang "zh-tw" }}精選文章{{ else }}Featured Posts{{ end }}
    </h2>

    {{- /* Desktop: 3 columns */ -}}
    <div class="hidden md:grid md:grid-cols-3 gap-8">
      {{- range $featured -}}
        {{ partial "grid-card.html" . }}
      {{- end -}}
    </div>

    {{- /* Mobile: Carousel */ -}}
    <div class="md:hidden">
      <div class="overflow-x-auto snap-x snap-mandatory flex gap-4 pb-4">
        {{- range $featured -}}
        <div class="snap-center flex-shrink-0 w-[85vw]">
          {{ partial "grid-card.html" . }}
        </div>
        {{- end -}}
      </div>
    </div>
  </div>
</section>
{{- end -}}

{{- /* Featured Guides */ -}}
{{- $guides := where (where .Site.RegularPages "Section" "guides") "Params.featured" true | first 3 -}}
{{- if $guides -}}
<section class="container mx-auto px-4 py-16">
  <h2 class="font-heading text-3xl md:text-4xl font-bold text-center mb-12">
    {{ if eq .Language.Lang "zh-tw" }}旅遊攻略{{ else }}Travel Guides{{ end }}
  </h2>

  <div class="max-w-3xl mx-auto space-y-6">
    {{- range $guides -}}
      {{ partial "list-card.html" . }}
    {{- end -}}
  </div>

  <div class="text-center mt-8">
    <a href="{{ "guides" | relLangURL }}" class="inline-block bg-primary dark:bg-primary-dark hover:bg-primary-dark dark:hover:bg-primary text-white font-bold py-3 px-8 rounded-lg transition-colors">
      {{ if eq .Language.Lang "zh-tw" }}查看更多{{ else }}View More{{ end }}
    </a>
  </div>
</section>
{{- end -}}

{{- /* Services Section */ -}}
<section class="bg-white dark:bg-gray-900 py-16">
  {{ partial "services.html" . }}
</section>

{{- /* Newsletter Signup */ -}}
<section class="container mx-auto px-4 py-16">
  {{ partial "signup.html" . }}
</section>

{{ end }}
